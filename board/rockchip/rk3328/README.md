# Rockchip RK3328 Board Support

This directory holds the board-specific assets that REG-Linux needs to build
images for Rockchip RK3328-based hardware. It contains kernel configuration,
patches, filesystem overlays and the per-device packaging metadata that `regen`
or `genimage` uses when producing final installable images.

## Repository layout

- `linux_patches/` – Miscellaneous kernel patches that are applied on top of
  the RK3328 tree. They cover Rockchip helpers, DRM/V4L2 tweaks, the RK3288
  temperature sensor workarounds, USB video bandwidth limits for Sinden, and
  LibreELEC-aligned fixes among others. Applying this directory results in the
  CONFIG-local driver fixes that REG-Linux expects on these boards.
- `linux-rk3328-defconfig.config` – The autogenerated kernel `.config` that
  builds an `arm64` kernel for RK3328. It is tuned for the REG-Linux buildroot
  toolchain and ships with `LOCALVERSION=-reglinux`.
- `fsoverlay/` – Filesystem overlay to drop into the target rootfs. It installs
  `usr/bin/cputemp`/`gputemp` and ALSA `alsa/cards/{Analog.conf,simple-card.conf,SPDIF.conf}`
  so that we ship the same monitoring helpers and audio defaults every time.
- `renegade/` – Renegade RK3328 board layout. The `boot/extlinux.conf`
  boots with `/boot/rk3328-roc-cc.dtb` and the `genimage.cfg` points to
  `uboot-multiboard/roc-cc-rk3328/u-boot-rockchip.bin`. `create-boot-script.sh`
  copies the `Image`, initramfs, update blobs and the Renegade device tree
  into the REG-Linux binaries tree.
- `rock64/` – ROCK64-specific variant. It mirrors the Renegade structure but
  uses `rk3328-rock64.dtb` and `uboot-multiboard/rock64-rk3328/u-boot-rockchip.bin`
  so the correct DTB and bootloader land in the VFAT partition.
- `patches/` – Currently empty, reserved for long-term board-specific patches
  that can’t be applied through the smaller `linux_patches/` directory.

## Image generation helpers

Both `renegade/` and `rock64/` ship:

- `boot/extlinux.conf` – Points to `/boot/linux`, the device tree and passes
  `initrd=/boot/initrd.lz4` with console parameters appropriate for UART on
  `ttyS2`.
- `create-boot-script.sh` – Install script invoked during image build. It
  expects six directories from the build system (`HOST_DIR` … `REGLINUX_BINARIES_DIR`)
  and copies the kernel, initramfs, update blobs, firmware, rescue image, and
  the board-specific DTB into the binaries drop. It also installs the `extlinux.conf`
  into the bootloader configuration area.
- `genimage.cfg` – Describes a combined image with a VFAT boot partition,
  an ext4 userdata partition (`/userdata`), and an HD image (`reglinux.img`)
  that contains three partitions: the ROM loader (partitioned with the board’s
  `uboot-multiboard` binary), the VFAT `boot.vfat`, and the `userdata.ext4`
  share partition.

When building, run the REG-Linux tooling so it can invoke `create-boot-script.sh`
and `genimage.cfg` from the appropriate board directory; those scripts assume
the binaries have already been staged by the REG-Linux build process.
